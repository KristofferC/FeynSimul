# -*- coding: utf-8 -*-


class Pisa3:

    """ Sum of two gaussian potentials.Three particle system but two
    degrees
    of freedowm with Jacobi coordinates
    """

    def __init__(self, threeBodyForce=True):

        self.userCode = """ inline float sqr(float x){return x*x;}
        		   inline float quad(float x){return x*x*x*x;}
                           #define SQRT3 1.732050807568877293               
                           #define INVSQRT2 0.707106781187
                           #define INVSQRT3 0.577350269190
                           #define INVSQRT4 0.5
                           #define INVSQRT6 0.408248290464
        """
        self.DOF = 6
##### THREE BODY POTENTIAL #####

        if threeBodyForce:
            #W0 = 0.279 rho0 = 16
            self.potential = """-2.4540000000000006*exp(-1.7209113238549558*sqr(x1) - 1.7209113238549558*sqr(x2) - 1.7209113238549558*sqr(x3)) + 0.5580000000000002*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6)) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)"""

            self.energyOp = """-2.4540000000000006*exp(-1.7209113238549558*sqr(x1) - 1.7209113238549558*sqr(x2) - 1.7209113238549558*sqr(x3)) + 0.5580000000000002*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6)) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6) + 0.5*(x4*(-2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-1.4903529241187008*x1 - 2.5813669857824335*x4) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(1.4903529241187008*x1 - 2.5813669857824335*x4) - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x4) + x1*(8.446232777480125*exp(-1.7209113238549558*sqr(x1) - 1.7209113238549558*sqr(x2) - 1.7209113238549558*sqr(x3))*x1 - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x1 - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-0.8604556619274779*x1 - 1.4903529241187008*x4) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(-0.8604556619274779*x1 + 1.4903529241187008*x4)) + x5*(-2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-1.4903529241187008*x2 - 2.5813669857824335*x5) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(1.4903529241187008*x2 - 2.5813669857824335*x5) - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x5) + x2*(8.446232777480125*exp(-1.7209113238549558*sqr(x1) - 1.7209113238549558*sqr(x2) - 1.7209113238549558*sqr(x3))*x2 - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x2 - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-0.8604556619274779*x2 - 1.4903529241187008*x5) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(-0.8604556619274779*x2 + 1.4903529241187008*x5)) + x6*(-2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-1.4903529241187008*x3 - 2.5813669857824335*x6) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(1.4903529241187008*x3 - 2.5813669857824335*x6) - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x6) + x3*(8.446232777480125*exp(-1.7209113238549558*sqr(x1) - 1.7209113238549558*sqr(x2) - 1.7209113238549558*sqr(x3))*x3 - 1.5094355816250014*exp(-1.3525408437500008*sqr(x1) - 1.3525408437500008*sqr(x2) - 1.3525408437500008*sqr(x3) - 1.3525408437500008*sqr(x4) - 1.3525408437500008*sqr(x5) - 1.3525408437500008*sqr(x6))*x3 - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) - 1.4903529241187008*x1*x4 - 1.4903529241187008*x2*x5 - 1.4903529241187008*x3*x6)*(-0.8604556619274779*x3 - 1.4903529241187008*x6) - 2.4540000000000006*exp(-0.43022783096373896*sqr(x1) - 0.43022783096373896*sqr(x2) - 0.43022783096373896*sqr(x3) - 1.2906834928912168*sqr(x4) - 1.2906834928912168*sqr(x5) - 1.2906834928912168*sqr(x6) + 1.4903529241187008*x1*x4 + 1.4903529241187008*x2*x5 + 1.4903529241187008*x3*x6)*(-0.8604556619274779*x3 + 1.4903529241187008*x6)))"""
            self.groundStateEnergy=0.252
        else:
            self.groundStateEnergy=0.3
